# Code Generation

In order to reuse the code in different projects, we have created a code generation script for the server-side and 
the client-side. All the logic is encapsulated in the ./makeEhrV2 folder. You will be able to create the insides of the EHR pages by running the deploy.sh script.

## Generating the EHR pages

In order to get the full context on how it works, we need to look into a few different topics:

1. The /ehr-definitions folders contains logic for generating the code for all the app. It basically encapsulates all the needed logic for generating the files inside the client pages. By logic, we mean the script content of the components to be generated. They are used for detailed definitions for each page, and they are used for generating the client side routes (inside and outside) and inside menu.

2. What do inside and outside mean? Inside refers to the EHR pages. Outside refers to the LMS pages. As a developer, you will need to know this in order to understand the code generation process. You just need the context for this, since if you are not the main developer, you will not need to generate the outside routes. Running the script will only encapsulate the inside routes generation.

3. Besides this, keep in mind that the insideRoutes.js file is also generated by the deploy.sh script. This file is used for generating the inside client side routes.

4. You shouldn't edit any of the files inside the ``inside`` folder. If you should edit the corresponding file inside the ``ehr-definitions`` folder.

5. Please, be mindful that as you use the code generation script, you will need to make sure that the ``ehr-definitions`` folder is up to date between the client-side and the server-side. See the section below in order to understand how to do this.

## Copying the ehr-definitions

Ehr-definitions was created in order to keep the code generation logic in one place. This way, we can reuse the logic in the client and server. It encapsulates all the common functionality between the them.  This script copies those definitions from the server-side to the client -side as well which should be replaced when running the deploy.sh script.

In order to do so, you will need to run the ``copy-common-src.sh`` script. This script will copy the ``ehr-definitions`` folder from the workspace (server-side) to the client. This is needed to keep the client-definitions up to date with the server-definitions.

Please keep in mind that it's crucial for the app to function that the ehr-definitions is properly tested as it's being copied. Running when running the copy-common-src.sh script, also making sure that the script returns no errors. If it does, you will need to fix the errors before pushing the code.
